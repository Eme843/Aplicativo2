---
title: "Informe de Generaci√≥n de N√∫meros Aleatorios"
subtitle: 'M√©todo: `r params$metodo`'
output: 
  html_document:
    toc: true
    toc_depth: 2
    number_sections: true
    theme: cerulean
params:
  metodo: NA
  num_generar: NA
  barras: NA
  semilla: NA
  constante_a: NA
  divisor_m: NA
  c_val: NA
  k_val: NA
  n_val: NA
  datos_generados: NULL
---

```{r setup, include=FALSE}
# Configuraci√≥n inicial del chunk
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE)
library(knitr)
library(dplyr)
```


## Introducci√≥n

Este documento presenta el informe t√©cnico y los resultados obtenidos de la generaci√≥n de `r params$num_generar` n√∫meros aleatorios a trav√©s del m√©todo de `r params$metodo` en el simulador. Los n√∫meros generados se encuentran en el intervalo $(0, 1)$.

## Par√°metros de Simulaci√≥n

Los n√∫meros aleatorios fueron generados utilizando la configuraci√≥n de entrada provista por el usuario.

**M√©todo:** `r params$metodo`

```{r}
# Funci√≥n para crear filas de la tabla de par√°metros
crear_fila <- function(nombre, valor, unidad = "") {
  if (!is.null(valor)) {
    data.frame(Parametro = nombre, Valor = paste0(valor, " ", unidad))
  } else {
    NULL
  }
}

# Tabla de par√°metros generales
metodo <- params$metodo
df_general <- data.frame(Parametro = c("M√©todo Empleado", "Cantidad de Valores Generados", "Barras del Histograma"), 
                         Valor = c(metodo, params$num_generar, params$barras))

# Construcci√≥n de la tabla de par√°metros espec√≠ficos por m√©todo
df_especifico <- switch(metodo,
  "Congruencial Multiplicativo" = bind_rows(
    crear_fila("Semilla ($X_0$)", params$semilla),
    crear_fila("Constante Multiplicativa ($a$)", params$constante_a),
    crear_fila("M√≥dulo ($m$)", params$divisor_m)
  ),
  "Congruencial Mixto" = bind_rows(
    crear_fila("Semilla ($X_0$)", params$semilla),
    crear_fila("Constante Multiplicativa ($a$)", params$constante_a),
    crear_fila("Constante Aditiva ($c$)", params$c_val),
    crear_fila("M√≥dulo ($m$)", params$divisor_m)
  ),
  "Cuadrados Medios" = bind_rows(
    crear_fila("Semilla ($X_0$)", params$semilla),
    crear_fila("N√∫mero de D√≠gitos ($k$)", params$k_val)
  ),
  "Lehmer" = bind_rows(
    crear_fila("Semilla ($X_0$)", params$semilla),
    crear_fila("N√∫mero de D√≠gitos ($n$)", params$n_val),
    crear_fila("Constante ($c$)", params$c_val)
  )
)

# Imprimir la tabla
kable(df_especifico, caption = "Par√°metros Espec√≠ficos del M√©todo", format = "html")
```

## Resultados Generados
### Distribuci√≥n (Gr√°fico)

El siguiente histograma muestra la distribuci√≥n de frecuencias de los `r params$num_generar` valores obtenidos. Una distribuci√≥n uniforme es esperada si el generador es adecuado.

```{r histograma, fig.width=9, fig.height=6}
# Recuperar datos y par√°metros para generar el gr√°fico
x <- params$datos_generados
if (length(x) == 0) {
    # Si no hay datos, muestra un mensaje de advertencia en lugar del gr√°fico
    cat("‚ö†Ô∏è ADVERTENCIA: No se generaron n√∫meros aleatorios con los par√°metros seleccionados o la simulaci√≥n fall√≥.")
} else {
    # Contin√∫a con la generaci√≥n del plot solo si hay datos
    bins_count <- as.integer(params$barras)
    metodo_nombre <- params$metodo
    
    # Generaci√≥n del plot (mismo c√≥digo que en el server de Shiny)
    bins <- seq(min(x), max(x), length.out = bins_count + 1)
    hist(x, breaks = bins, col = "#00CD00", border = 'white', 
         xlab = 'N√∫meros aleatorios generados', 
         main = paste('Histograma del M√©todo: ', metodo_nombre),
         ylab = 'Frecuencia')
}
```

### Valores (Tabla de Datos)

Se presentan los primeros $\min(100, \text{Cantidad de N√∫meros})$ valores generados por el m√©todo seleccionado.

```{r}
# *** üö® NUEVA VERIFICACI√ìN DE DATOS üö® ***
if (length(params$datos_generados) == 0) {
    cat("‚ö†Ô∏è No hay datos disponibles para mostrar la tabla.")
} else {
    # Tomar los primeros 100 valores o todos si son menos
    datos_tabla <- data.frame(
      √çndice = 1:length(params$datos_generados),
      Valor_Generado = params$datos_generados
    ) %>% head(100)
    
    kable(datos_tabla, 
          digits = 8, 
          caption = paste("Muestra de los primeros", nrow(datos_tabla), "n√∫meros aleatorios"), 
          format = "html")
}
```